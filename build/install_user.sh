#!/bin/bash -xe

backup()
{
	FILE="$1"
	BACKUP_FILE="${FILE}.bak.${PROJECT}"
	if [ -f "$BACKUP_FILE" ]; then
		echo "cannot backup ${FILE}" >&2
		exit 2
	fi
	if [ -f "$FILE" ]; then
		cp "$FILE" "$BACKUP_FILE"
	fi
}

rmbackup()
{
	FILE="$1"
	BACKUP_FILE="${FILE}.bak.${PROJECT}"
	rm -f "$BACKUP_FILE"
}

[ $# -eq 1 ] || exit 1

PARAMS_FILE="$1"

. "${PARAMS_FILE}"

backup ~/.bashrc
echo ". $ETC_PLACEHOLDER/bashrc # generated by $PROJECT" >> ~/.bashrc
rmbackup ~/.bashrc

backup ~/.vimrc
echo "source $ETC_PLACEHOLDER/vimrc \" generated by $PROJECT" >> ~/.vimrc
rmbackup ~/.vimrc
